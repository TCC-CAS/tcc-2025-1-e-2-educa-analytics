<div class="frequencia-container">
  <div class="header">
    <h1>FrequÃªncia dos Educandos</h1>
  </div>

  <!-- Filtros -->
  <div class="filters-section">
    <h3>Filtros</h3>
    <div class="filters-grid">
      <div class="filter-field">
        <label>PerÃ­odo Letivo *</label>
        <select [(ngModel)]="periodoLetivo" (ngModelChange)="aplicarFiltros()">
          <option value="">Selecione</option>
          <option value="2026-1">2026/1</option>
          <option value="2026-2">2026/2</option>
          <option value="2025-2">2025/2</option>
        </select>
      </div>

      <div class="filter-field">
        <label>Turma *</label>
        <select [(ngModel)]="turma" (ngModelChange)="aplicarFiltros()">
          <option value="">Selecione</option>
          <option value="6A">6Âº Ano A</option>
          <option value="6B">6Âº Ano B</option>
          <option value="7A">7Âº Ano A</option>
          <option value="8A">8Âº Ano A</option>
        </select>
      </div>

      <div class="filter-field">
        <label>Disciplina *</label>
        <select [(ngModel)]="disciplina" (ngModelChange)="aplicarFiltros()">
          <option value="">Selecione</option>
          <option value="matematica">MatemÃ¡tica</option>
          <option value="portugues">PortuguÃªs</option>
          <option value="historia">HistÃ³ria</option>
          <option value="ciencias">CiÃªncias</option>
        </select>
      </div>

      <div class="filter-actions">
        <button class="btn-secondary" (click)="limparFiltros()">Limpar</button>
      </div>
    </div>
  </div>

  <!-- AÃ§Ãµes de Registro (para educadores) -->
  <div class="action-bar" *ngIf="educandosFiltrados.length > 0 && !modoEdicao">
    <button class="btn-primary" (click)="habilitarEdicao()">
      ğŸ“ Registrar FrequÃªncia
    </button>
  </div>

  <!-- Modo de EdiÃ§Ã£o -->
  <div class="edit-bar" *ngIf="modoEdicao">
    <div class="edit-info">
      <label>Data da Aula:</label>
      <input type="date" [(ngModel)]="dataAula">
    </div>
    <div class="edit-actions">
      <button class="btn-ghost" (click)="cancelarEdicao()">Cancelar</button>
      <button class="btn-primary" (click)="salvarFrequencia()">Salvar FrequÃªncia</button>
    </div>
  </div>

  <!-- Tabela -->
  <div class="table-container" *ngIf="educandosFiltrados.length > 0">
    <table>
      <thead>
        <tr>
          <th>MatrÃ­cula</th>
          <th>Nome do Educando</th>
          <th class="center">PresenÃ§as</th>
          <th class="center">Faltas</th>
          <th class="center">FrequÃªncia</th>
          <th class="center" *ngIf="modoEdicao">Registrar</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let educando of educandosFiltrados">
          <td>{{ educando.matricula }}</td>
          <td><strong>{{ educando.nome }}</strong></td>
          <td class="center">{{ educando.presencas }}</td>
          <td class="center">{{ educando.faltas }}</td>
          <td class="center">
            <span class="badge-frequencia" [ngClass]="getStatusClass(educando.percentualFrequencia)">
              {{ educando.percentualFrequencia.toFixed(1) }}%
            </span>
          </td>
          <td class="center action-buttons" *ngIf="modoEdicao">
            <button 
              class="btn-presenca" 
              [class.selected]="educando.presencaHoje === true"
              (click)="marcarPresenca(educando)"
              title="Marcar PresenÃ§a">
              âœ“ P
            </button>
            <button 
              class="btn-falta" 
              [class.selected]="educando.presencaHoje === false"
              (click)="marcarFalta(educando)"
              title="Marcar Falta">
              âœ• F
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Mensagem de filtro vazio -->
  <div class="empty-state" *ngIf="educandosFiltrados.length === 0">
    <p>Selecione o perÃ­odo letivo, turma e disciplina para visualizar a frequÃªncia dos educandos</p>
  </div>

  <!-- Legenda -->
  <div class="legend" *ngIf="educandosFiltrados.length > 0 && !modoEdicao">
    <h4>Legenda:</h4>
    <div class="legend-items">
      <span class="legend-item">
        <span class="badge-frequencia status-excelente">95%+</span> Excelente
      </span>
      <span class="legend-item">
        <span class="badge-frequencia status-bom">85-94%</span> Bom
      </span>
      <span class="legend-item">
        <span class="badge-frequencia status-atencao">75-84%</span> AtenÃ§Ã£o
      </span>
      <span class="legend-item">
        <span class="badge-frequencia status-critico">&lt;75%</span> CrÃ­tico
      </span>
    </div>
  </div>
</div>
